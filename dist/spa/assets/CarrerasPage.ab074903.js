import{z as s,f as x,n as V,o as k,c as D,w as l,H as d,a as o,L as f,I as q,K as y,M as B,N,Q as w,Z as S,b5 as z}from"./index.0418bc8d.js";import{Q as I}from"./QTooltip.616e6e1b.js";import{Q as A,a as E}from"./QTable.17f2e81d.js";import{Q as M}from"./QForm.0e8df789.js";import{Q as T}from"./QPage.c34053e1.js";import{u as L}from"./use-quasar.d200e14e.js";import{api as g}from"./axios.0ee954dc.js";import{_ as P}from"./plugin-vue_export-helper.21dcd24c.js";import"./position-engine.40d3e3b8.js";import"./QList.329cacdc.js";import"./QSelect.e99ebc92.js";import"./QChip.9d792c62.js";import"./QItem.b86f3ea8.js";const U={name:"CarrerasPage",setup(){const n=L(),e=s([]),m=s(!1),a=s(!1),u=s(!1),i=s(!1),r=s({nombre:""}),c=s(""),C=[{name:"nombre",label:"Nombre",field:"nombre",align:"left",sortable:!0},{name:"actions",label:"Acciones",align:"center"}],Q=x(()=>{if(!c.value)return e.value;const t=c.value.toLowerCase();return e.value.filter(p=>{var b;return(b=p.nombre)==null?void 0:b.toLowerCase().includes(t)})}),v=async()=>{m.value=!0;try{const t=localStorage.getItem("token"),p=await g.get("/carreras",{headers:{Authorization:`Bearer ${t}`}});e.value=p.data}catch{n.notify({type:"negative",message:"Error al cargar carreras"})}finally{m.value=!1}},h=(t=null)=>{t?(r.value={...t},i.value=!0):(r.value={nombre:""},i.value=!1),u.value=!0},_=async()=>{a.value=!0;try{const t=localStorage.getItem("token");i.value?(await g.put(`/carreras/${r.value.id}`,r.value,{headers:{Authorization:`Bearer ${t}`}}),n.notify({type:"positive",message:"Carrera actualizada"})):(await g.post("/carreras",r.value,{headers:{Authorization:`Bearer ${t}`}}),n.notify({type:"positive",message:"Carrera creada"})),u.value=!1,v()}catch{n.notify({type:"negative",message:"Error al guardar"})}finally{a.value=!1}};return V(()=>{v()}),{carreras:e,loading:m,saving:a,showDialog:u,editMode:i,form:r,columns:C,searchQuery:c,filteredCarreras:Q,openDialog:h,saveCarrera:_}}},G={class:"q-mb-md"},j={class:"row justify-between items-center q-mb-md"},F={class:"text-h6"},H={class:"row q-gutter-sm"};function K(n,e,m,a,u,i){return k(),D(T,{padding:""},{default:l(()=>[d("div",G,[d("div",j,[e[5]||(e[5]=d("div",{class:"text-h5 text-weight-medium"},"Gesti\xF3n de Carreras",-1)),o(f,{color:"primary",label:"Nueva Carrera",icon:"add",onClick:e[0]||(e[0]=r=>a.openDialog()),unelevated:""})]),o(y,{modelValue:a.searchQuery,"onUpdate:modelValue":e[1]||(e[1]=r=>a.searchQuery=r),outlined:"",dense:"",placeholder:"Buscar por nombre...",class:"q-mb-md",clearable:"",style:{"max-width":"400px"}},{prepend:l(()=>[o(q,{name:"search"})]),_:1},8,["modelValue"])]),o(E,{rows:a.filteredCarreras,columns:a.columns,"row-key":"id",loading:a.loading,flat:"",bordered:"","rows-per-page-options":[10,25,50],class:"shadow-1"},{"body-cell-actions":l(r=>[o(A,{props:r},{default:l(()=>[o(f,{flat:"",dense:"",color:"primary",icon:"edit",onClick:c=>a.openDialog(r.row)},{default:l(()=>[o(I,null,{default:l(()=>[...e[6]||(e[6]=[B("Editar",-1)])]),_:1})]),_:1},8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","loading"]),o(z,{modelValue:a.showDialog,"onUpdate:modelValue":e[4]||(e[4]=r=>a.showDialog=r)},{default:l(()=>[o(N,{style:{"min-width":"400px"}},{default:l(()=>[o(w,{class:"bg-primary text-white"},{default:l(()=>[d("div",F,S(a.editMode?"Editar Carrera":"Nueva Carrera"),1)]),_:1}),o(w,null,{default:l(()=>[o(M,{onSubmit:a.saveCarrera},{default:l(()=>[o(y,{modelValue:a.form.nombre,"onUpdate:modelValue":e[2]||(e[2]=r=>a.form.nombre=r),label:"Nombre",outlined:"",dense:"",class:"q-mb-md",rules:[r=>!!r||"Requerido"]},null,8,["modelValue","rules"]),d("div",H,[o(f,{label:"Cancelar",color:"grey",flat:"",onClick:e[3]||(e[3]=r=>a.showDialog=!1)}),o(f,{type:"submit",label:"Guardar",color:"primary",loading:a.saving},null,8,["loading"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}var le=P(U,[["render",K]]);export{le as default};
